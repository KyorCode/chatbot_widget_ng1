!function(t){"use strict";t.module("akit.component.chatservicerButton",[])}(window.angular),function(t){"use strict";t.module("akit.component.chatservicerButton",[])}(window.angular),function(t){"use strict";t.module("akit.component.chatservicerButton").constant("akit.component.chatservicerButton.chatproxyConfig",{chatproxyServiceUrl:"/srv/chatproxy/d/"})}(window.angular),function(t){"use strict";t.module("akit.component.chatservicerButton").controller("akit.component.chatservicerButton.chatservicerButtonController",["$scope","$timeout","akit.component.chatservicerButto.chatproxyService",function(t,e,n){function a(){n.getAvailability(t.entitykey).then(function(t){s.available=t.data.available,p=0,c()})["catch"](function(t){s.available=!1,p+=1,c(2*p*u)})}function c(t){t=t||u,i(),l=e(a,t)}function i(){e.cancel(l)}function o(){var e=n.getChatURL(t.entitykey);return e.data.url}function r(e){var n="chatservicer_window",a="width=640,height=480,resizable,scrollbars=yes,status=1",r=t.urlWhenUnavailable||"https://www.google.com";if(!e)return void window.open(r,n,a);var l=o();if(!s.chatWindow.closed)return void s.chatWindow.focus();if(s.disabled=!1,s.available)if(l){i();var u=l;s.chatWindow=window.open(u,n,a),s.disabled=!0}else s.occupied=!0,s.popupOpen=!s.popupOpen,s.available=!1,c(5e3);else s.popupOpen&&s.occupied?s.popupOpen=!1:(s.occupied=!1,s.popupOpen=!s.popupOpen)}var l,s=this,u=1e3,p=0;s.chatWindow={closed:!0},s.available,s.disabled=!1,s.occupied=!1,s.popupOpen=!1,s.clickHandler=r,s.nextPoll=c,s.cancelPoll=i,s.getChatAvailability=a}])}(window.angular),function(t){"use strict";t.module("akit.component.chatservicerButton").directive("chatservicerButton",["$timeout","$window",function(t,e){return{restrict:"AE",replace:!0,templateUrl:"/assets/chatservicer-button/views/directives/chatservicer-button.htm",controller:"akit.component.chatservicerButton.chatservicerButtonController",controllerAs:"chatservicer",scope:{entitykey:"@",urlWhenUnavailable:"@",availabilityServiceUrl:"@",buttonText:"@",buttonTextNoAgent:"@",getLinkServiceUrl:"@"},link:function(n,a,c,i){function o(){i.getChatAvailability()}n.$watch("chatservicer.available",function(t,e){t===e||i.disabled||(!i.occupied||i.occupied&&t===!0)&&i.nextPoll(2e3)}),n.$on("$destroy",function(){i.chatWindow.closed||i.chatWindow.close(),i.cancelPoll()}),e.addEventListener("focus",function(){t(function(){i.chatWindow.closed&&(i.disabled=!1,i.nextPoll())})}),o()}}}])}(window.angular),function(t){"use strict";t.module("akit.component.chatservicerButton").service("akit.component.chatservicerButto.chatproxyService",["$http","$interval","$q","akit.component.chatservicerButton.chatproxyConfig",function(t,e,n,a){function c(t){function e(t){var e=n.defer();return t.success?e.resolve(t):e.reject(t),e.promise}return e(l)}function i(t){return{success:!0,data:{url:"https://talk.attendedbyhumans.com/tbv1/call_chat_design.php?agent=santwerp"}}}var o={},r=10,l={success:!0,data:{available:!0}};return e(function(){var t=!l.data.available;l.data.available=t},1e3*r),o.getAvailability=c,o.getChatURL=i,o}])}(window.angular),angular.module("akit.component.chatservicerButton").run(["$templateCache",function(t){t.put("/assets/chatservicer-button/views/directives/chatservicer-button.htm",'<div class="chatservicer-button">\n    <button type="button"\n            class="button has-icon"\n            ng-class="{\'success\': chatservicer.available}"\n            ng-click="chatservicer.clickHandler(chatservicer.available)">\n        <span class="fa fa-comments"></span>\n        <span ng-if="chatservicer.available">\n            <span>{{ buttonText || \'Chat met een medewerker\'}}</span>\n        </span>\n        <span ng-if="!chatservicer.available">\n            <span>{{buttonTextNoAgent || \'Hulp nodig bij het invullen?\'}}</span>\n        </span>\n    </button>\n</div>')}]);
//# sourceMappingURL=akit.component.chatservicer-button.min.js.map
